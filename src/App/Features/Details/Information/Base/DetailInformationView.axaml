<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             x:Class="Misa.Ui.Avalonia.Features.Details.Information.Base.DetailInformationView"
             xmlns:base="clr-namespace:Misa.Ui.Avalonia.Features.Details.Information.Base"
             x:DataType="base:DetailInformationViewModel">

    <UserControl.Styles>

        <!-- Card -->
        <Style Selector="Border.misa-card">
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="{StaticResource BrushBorder}"/>
            <Setter Property="Background" Value="{StaticResource BrushPrimaryBackgroundLighter}"/>
            <Setter Property="Padding" Value="14"/>
            <Setter Property="Margin" Value="0"/>
        </Style>

        <!-- Header -->
        <Style Selector="TextBlock.misa-card-title">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Margin" Value="0,0,0,6"/>
        </Style>

        <Style Selector="TextBlock.misa-label">
            <Setter Property="Opacity" Value="0.7"/>
            <Setter Property="FontSize" Value="12"/>
        </Style>

        <Style Selector="TextBlock.misa-value">
            <Setter Property="FontSize" Value="13"/>
        </Style>

        <!-- Inputs -->
        <Style Selector="TextBox.misa-input">
            <Setter Property="Background" Value="{StaticResource BrushPrimaryBackground}"/>
            <Setter Property="BorderBrush" Value="{StaticResource BrushBorder}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="10,8"/>
        </Style>

        <Style Selector="ComboBox.misa-input">
            <Setter Property="Background" Value="{StaticResource BrushPrimaryBackground}"/>
            <Setter Property="BorderBrush" Value="{StaticResource BrushBorder}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="10,6"/>
        </Style>

        <Style Selector="NumericUpDown.misa-input">
            <Setter Property="Background" Value="{StaticResource BrushPrimaryBackground}"/>
            <Setter Property="BorderBrush" Value="{StaticResource BrushBorder}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="10,6"/>
        </Style>

        <!-- Action buttons -->
        <Style Selector="Button.misa-action">
            <Setter Property="Height" Value="34"/>
            <Setter Property="Width" Value="34"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="HorizontalAlignment" Value="Center"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="{StaticResource BrushBorder}"/>
            <Setter Property="Background" Value="{StaticResource BrushPrimaryBackground}"/>
        </Style>

        <Style Selector="Button.misa-action-text">
            <Setter Property="Height" Value="32"/>
            <Setter Property="Padding" Value="10,0"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="{StaticResource BrushBorder}"/>
            <Setter Property="Background" Value="{StaticResource BrushPrimaryBackground}"/>
        </Style>

        <!-- Detail mini cards -->
        <Style Selector="Border.misa-detail-information-item">
            <Setter Property="Margin" Value="0,0,10,10"/>
            <Setter Property="Padding" Value="12"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="{StaticResource BrushBorder}"/>
            <Setter Property="Background" Value="{StaticResource BrushPrimaryBackground}"/>
        </Style>

        <Style Selector="Button.misa-detail-information-item-button">
            <Setter Property="Padding" Value="4"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Opacity" Value="0.65"/>
        </Style>

    </UserControl.Styles>

    <ScrollViewer Padding="14"
                  HorizontalScrollBarVisibility="Disabled">
        <StackPanel Spacing="12">

            <ContentControl Content="{Binding DeadlineSection}"/>
            <ContentControl Content="{Binding Session}"/>

            <Border Classes="misa-card">
                <StackPanel Spacing="12">

                    <TextBlock Text="Information"
                               Classes="misa-card-title"/>

                    <!-- Top meta -->
                    <Grid ColumnDefinitions="140,*,Auto"
                          RowDefinitions="Auto,Auto,Auto,Auto,Auto"
                          RowSpacing="8"
                          ColumnSpacing="10">

                        <!-- Id -->
                        <TextBlock Grid.Row="0" Grid.Column="0"
                                   Text="Id"
                                   Classes="misa-label"/>
                        <TextBlock Grid.Row="0" Grid.Column="1"
                                   Text="{Binding Parent.Item.Id}"
                                   Classes="misa-value"
                                   TextWrapping="Wrap"/>
                        <Button Grid.Row="0" Grid.Column="2"
                                Classes="misa-action"
                                ToolTip.Tip="Copy"
                                Command="{Binding CopyIdCommand}">
                            <Image Width="16" Height="16"
                                   Source="{SvgImage /Assets/Images/Details/copy.svg}"/>
                        </Button>

                        <!-- Title -->
                        <TextBlock Grid.Row="1" Grid.Column="0"
                                   Text="Title"
                                   Classes="misa-label"/>

                        <Grid Grid.Row="1" Grid.Column="1"
                              RowDefinitions="Auto,Auto"
                              RowSpacing="8">

                            <TextBlock Grid.Row="0"
                                       Text="{Binding Parent.Item.Title}"
                                       Classes="misa-value"
                                       TextWrapping="Wrap"
                                       IsVisible="{Binding !IsEditTitleFormOpen}"/>

                            <TextBox Grid.Row="0"
                                     Classes="misa-input"
                                     Text="{Binding Title, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                     IsVisible="{Binding IsEditTitleFormOpen}"/>

                            <StackPanel Grid.Row="1"
                                        Orientation="Horizontal"
                                        Spacing="8"
                                        IsVisible="{Binding IsEditTitleFormOpen}">

                                <Button Classes="misa-action-text"
                                        Command="{Binding CloseEditTitleFormCommand}">
                                    <TextBlock Text="Cancel"/>
                                </Button>

                                <Button Classes="misa-action-text"
                                        Command="{Binding UpdateTitleTaskCommand}">
                                    <TextBlock Text="Save"/>
                                </Button>
                            </StackPanel>
                        </Grid>

                        <Button Grid.Row="1" Grid.Column="2"
                                Classes="misa-action"
                                ToolTip.Tip="Edit"
                                Command="{Binding ShowEditTitleFormCommand}"
                                IsVisible="{Binding !IsEditTitleFormOpen}">
                            <Image Width="16" Height="16"
                                   Source="{SvgImage /Assets/Images/Details/pencil.svg}"/>
                        </Button>

                        <!-- Created -->
                        <TextBlock Grid.Row="2" Grid.Column="0"
                                   Text="Created"
                                   Classes="misa-label"/>
                        <TextBlock Grid.Row="2" Grid.Column="1"
                                   Text="{Binding Parent.Item.Entity.CreatedAt, StringFormat={}{0:yyyy-MM-dd HH:mm}}"
                                   Classes="misa-value"/>

                        <!-- Updated -->
                        <TextBlock Grid.Row="3" Grid.Column="0"
                                   Text="Updated"
                                   Classes="misa-label"/>
                        <TextBlock Grid.Row="3" Grid.Column="1"
                                   Text="{Binding Parent.Item.Entity.UpdatedAt, StringFormat={}{0:yyyy-MM-dd HH:mm}}"
                                   Classes="misa-value"/>

                        <!-- Interacted -->
                        <TextBlock Grid.Row="4" Grid.Column="0"
                                   Text="Interacted"
                                   Classes="misa-label"/>
                        <TextBlock Grid.Row="4" Grid.Column="1"
                                   Text="{Binding Parent.Item.Entity.InteractedAt, StringFormat={}{0:yyyy-MM-dd HH:mm}}"
                                   Classes="misa-value"/>

                    </Grid>

                    <!-- Cards -->
                    <UniformGrid Columns="2"
                                 HorizontalAlignment="Stretch">

                        <!-- Workflow -->
                        <Border Classes="misa-detail-information-item">
                            <StackPanel Spacing="6">
                                <TextBlock Text="Workflow" Classes="misa-label"/>
                                <TextBlock Text="{Binding Parent.Item.Entity.Workflow}"
                                           FontWeight="SemiBold"/>
                            </StackPanel>
                        </Border>

                        <!-- State -->
                        <Border Classes="misa-detail-information-item">
                            <Grid>
                                <StackPanel Spacing="6">
                                    <TextBlock Text="State" Classes="misa-label"/>
                                    <TextBlock Text="{Binding Parent.Item.StateId}"
                                               FontWeight="SemiBold"/>
                                </StackPanel>

                                <Button Classes="misa-detail-information-item-button"
                                        HorizontalAlignment="Right"
                                        VerticalAlignment="Top"
                                        Command="{Binding EditStateCommand}"
                                        Margin="2"
                                        ToolTip.Tip="Edit">
                                    <Image Width="14"
                                           Height="14"
                                           Source="{SvgImage /Assets/Images/Details/pencil.svg}"/>
                                </Button>
                            </Grid>
                        </Border>

                        <!-- Priority -->
                        <Border Classes="misa-detail-information-item">
                            <StackPanel Spacing="6">
                                <TextBlock Text="Priority" Classes="misa-label"/>
                                <TextBlock Text="{Binding Parent.Item.Priority}"
                                           FontWeight="SemiBold"/>
                            </StackPanel>
                        </Border>

                        <!-- Category -->
                        <Border Classes="misa-detail-information-item"
                                IsVisible="{Binding HasTaskExtension}">
                            <StackPanel Spacing="6">
                                <TextBlock Text="Category" Classes="misa-label"/>
                                <TextBlock Text="{Binding TaskExtension.Category}"
                                           FontWeight="SemiBold"/>
                            </StackPanel>
                        </Border>

                    </UniformGrid>

                </StackPanel>
            </Border>

            <ContentControl Content="{Binding Description}"/>

        </StackPanel>
    </ScrollViewer>
</UserControl>
