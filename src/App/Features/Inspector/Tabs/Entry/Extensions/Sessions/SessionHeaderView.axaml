<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             x:Class="Misa.Ui.Avalonia.Features.Inspector.Tabs.Entry.Extensions.Sessions.SessionHeaderView"
             xmlns:root="clr-namespace:Misa.Ui.Avalonia.Features.Inspector.Tabs.Entry.Base"
             xmlns:sessions="clr-namespace:Misa.Ui.Avalonia.Features.Inspector.Tabs.Entry.Extensions.Sessions"
             x:DataType="root:InspectorEntryViewModel">

    <Border Padding="10"
            BorderThickness="0,0,0,1"
            BorderBrush="{StaticResource BrushBorder}">
        
        <Grid ColumnDefinitions="Auto,*,Auto"
              VerticalAlignment="Center">

            <!-- Has none active Session -->
            <TextBlock Grid.Column="0"
                       Text="Currently has no active Session."
                       VerticalAlignment="Center"
                       IsVisible="{Binding !HasActiveSession}" />
            
            <!-- Segment -->
            <TextBlock Grid.Column="0"
                       VerticalAlignment="Center"
                       Text="{Binding ActiveSessionSegmentDisplay}"
                       IsVisible="{Binding HasActiveSession}"/>

            <!-- Elapsed -->
            <TextBlock Grid.Column="1"
                       VerticalAlignment="Center"
                       HorizontalAlignment="Center"
                       Text="{Binding ActiveSessionElapsedDisplay}" />

            <!-- Quick Actions -->
            <StackPanel Grid.Column="2"
                        Orientation="Horizontal"
                        Spacing="8"
                        VerticalAlignment="Center">

                <Button Command="{Binding ShowStartSessionPanelCommand}"
                        IsVisible="{Binding CanStartSession}">
                    <Image Width="16" Height="16"
                           Source="{SvgImage /Assets/Icons/Inspector/Session/play.svg}"/>
                </Button>

                <Button Command="{Binding ShowPauseSessionPanelCommand}"
                        IsVisible="{Binding CanPauseSession}">
                    <Image Width="16" Height="16"
                           Source="{SvgImage /Assets/Icons/Inspector/Session/pause.svg}"/>
                </Button>

                <Button Command="{Binding ContinueSessionCommand}"
                        IsVisible="{Binding CanContinueSession}">
                    <Image Width="16" Height="16"
                           Source="{SvgImage /Assets/Icons/Inspector/Session/play-pause.svg}"/>
                </Button>

                <Button Command="{Binding ShowEndSessionPanelCommand}"
                        IsVisible="{Binding CanEndSession}">
                    <Image Width="16" Height="16"
                           Source="{SvgImage /Assets/Icons/Inspector/Session/stop.svg}"/>
                </Button>

                <!-- Dropdown (nur wenn Session läuft) -->
                <DropDownButton IsVisible="{Binding HasActiveSession}"
                                VerticalAlignment="Center">

                    <DropDownButton.Content>
                        <TextBlock Text="▾" FontSize="16" />
                    </DropDownButton.Content>

                    <DropDownButton.Flyout>
                        <Flyout Placement="Bottom">
                            <StackPanel>
                                <sessions:CurrentSessionView />
                            </StackPanel>
                        </Flyout>
                    </DropDownButton.Flyout>

                </DropDownButton>
                
            </StackPanel>
        </Grid>
    </Border>
</UserControl>
