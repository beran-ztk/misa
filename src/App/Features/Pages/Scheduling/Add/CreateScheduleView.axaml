<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
             x:Class="Misa.Ui.Avalonia.Features.Pages.Scheduling.Add.CreateScheduleView"
             xmlns:root="clr-namespace:Misa.Ui.Avalonia.Features.Pages.Scheduling.Root"
             x:DataType="root:SchedulerFacadeViewModel">

    <Border Classes="workspace-addpanel">

        <Grid RowDefinitions="Auto,Auto,*,Auto,Auto"
              Classes="workspace-addpanel">

            <!-- Header -->
            <Grid Grid.Row="0"
                  ColumnDefinitions="*,Auto">

                <TextBlock Text="Create new Schedule"
                           Classes="workspace-addpanel-title"/>

                <Button Grid.Column="1"
                        Classes="workspace-addpanel-icon"
                        Command="{Binding CloseAddPanelCommand}">
                    <Image Source="{SvgImage /Assets/Icons/Common/cancel.svg}" />
                </Button>
            </Grid>

            <Border Grid.Row="1"
                    Classes="panel-divider"/>

            <!-- Body -->
            <ScrollViewer Grid.Row="2"
                          Padding="10"
                          DataContext="{Binding State.CreateScheduleState}">
                <StackPanel Classes="workspace-addpanel-body"
                            Spacing="16">

                    <!-- Title -->
                    <StackPanel Classes="workspace-addpanel-body">
                        <TextBlock Text="Add a title"
                                   Classes="workspace-addpanel-body"/>

                        <TextBox Classes="workspace-addpanel-body-text-oneliner"
                                 Watermark="Title…"
                                 Text="{Binding Title, Mode=TwoWay}" />

                        <TextBlock Text="{Binding ErrorMessage}"
                                   IsVisible="{Binding HasValidationError}" />
                    </StackPanel>

                    <!-- Frequency -->
                    <StackPanel Classes="workspace-addpanel-body">
                        <TextBlock Text="Select the frequency type"
                                   Classes="workspace-addpanel-body"/>

                        <ComboBox Classes="workspace-addpanel-body-selector"
                                  ItemsSource="{Binding FrequencyTypes}"
                                  SelectedValue="{Binding SelectedFrequencyType}" />
                    </StackPanel>

                    <StackPanel Classes="workspace-addpanel-body">
                        <TextBlock Text="Set the interval"
                                   Classes="workspace-addpanel-body"/>

                        <NumericUpDown Classes="workspace-addpanel-body-selector"
                                       Value="{Binding FrequencyInterval, Mode=TwoWay}"
                                       Minimum="1"
                                       Maximum="1000"
                                       Increment="1"
                                       FormatString="N0" />
                    </StackPanel>

                    <!-- Lookahead -->
                    <StackPanel Classes="workspace-addpanel-body">
                        <TextBlock Text="Lookahead limit"
                                   Classes="workspace-addpanel-body"/>

                        <NumericUpDown Classes="workspace-addpanel-body-selector"
                                       Value="{Binding LookaheadLimit, Mode=TwoWay}"
                                       Minimum="1"
                                       Maximum="100"
                                       Increment="1"
                                       FormatString="N0" />
                    </StackPanel>

                    <!-- Occurrence limit -->
                    <StackPanel Classes="workspace-addpanel-body">
                        <TextBlock Text="Occurrence count limit (optional)"
                                   Classes="workspace-addpanel-body"/>

                        <NumericUpDown Classes="workspace-addpanel-body-selector"
                                       Value="{Binding OccurrenceCountLimit, Mode=TwoWay}"
                                       Minimum="0"
                                       Maximum="100000"
                                       Increment="1"
                                       FormatString="N0" />
                    </StackPanel>

                    <!-- Misfire policy -->
                    <StackPanel Classes="workspace-addpanel-body">
                        <TextBlock Text="Select misfire policy"
                                   Classes="workspace-addpanel-body"/>

                        <ComboBox Classes="workspace-addpanel-body-selector"
                                  ItemsSource="{Binding MisfirePolicies}"
                                  SelectedValue="{Binding SelectedMisfirePolicy, Mode=TwoWay}" />
                    </StackPanel>

                    <!-- Occurrence TTL -->
                    <StackPanel Classes="workspace-addpanel-body">
                        <TextBlock Text="Occurrence TTL (optional)"
                                   Classes="workspace-addpanel-body"/>

                        <Grid ColumnDefinitions="Auto,*"
                              RowDefinitions="Auto,Auto,Auto"
                              ColumnSpacing="12"
                              RowSpacing="10">

                            <TextBlock Grid.Row="0" Grid.Column="0"
                                       VerticalAlignment="Center"
                                       Text="Days"
                                       Classes="workspace-addpanel-body"/>
                            <NumericUpDown Grid.Row="0" Grid.Column="1"
                                           Classes="workspace-addpanel-body-selector"
                                           Minimum="0"
                                           Increment="1"
                                           Value="{Binding OccurrenceTtlDays, Mode=TwoWay}" />

                            <TextBlock Grid.Row="1" Grid.Column="0"
                                       VerticalAlignment="Center"
                                       Text="Hours"
                                       Classes="workspace-addpanel-body"/>
                            <NumericUpDown Grid.Row="1" Grid.Column="1"
                                           Classes="workspace-addpanel-body-selector"
                                           Minimum="0"
                                           Maximum="23"
                                           Increment="1"
                                           Value="{Binding OccurrenceTtlHours, Mode=TwoWay}" />

                            <TextBlock Grid.Row="2" Grid.Column="0"
                                       VerticalAlignment="Center"
                                       Text="Minutes"
                                       Classes="workspace-addpanel-body"/>
                            <NumericUpDown Grid.Row="2" Grid.Column="1"
                                           Classes="workspace-addpanel-body-selector"
                                           Minimum="0"
                                           Maximum="59"
                                           Increment="1"
                                           Value="{Binding OccurrenceTtlMinutes, Mode=TwoWay}" />
                        </Grid>
                    </StackPanel>

                    <!-- Time window -->
                    <StackPanel Classes="workspace-addpanel-body">
                        <TextBlock Text="Start time (optional)"
                                   Classes="workspace-addpanel-body"/>
                        <TimePicker Classes="workspace-addpanel-body-selector"
                                    SelectedTime="{Binding StartTime, Mode=TwoWay}" />
                    </StackPanel>

                    <StackPanel Classes="workspace-addpanel-body">
                        <TextBlock Text="End time (optional)"
                                   Classes="workspace-addpanel-body"/>
                        <TimePicker Classes="workspace-addpanel-body-selector"
                                    SelectedTime="{Binding EndTime, Mode=TwoWay}" />
                    </StackPanel>

                    <!-- Active range -->
                    <StackPanel Classes="workspace-addpanel-body">
                        <TextBlock Text="Active from"
                                   Classes="workspace-addpanel-body"/>

                        <StackPanel Orientation="Horizontal"
                                    Spacing="10">
                            <DatePicker SelectedDate="{Binding ActiveFromDate, Mode=TwoWay}" />
                            <TimePicker SelectedTime="{Binding ActiveFromTime, Mode=TwoWay}" />
                        </StackPanel>
                    </StackPanel>

                    <StackPanel Classes="workspace-addpanel-body">
                        <TextBlock Text="Active until (optional)"
                                   Classes="workspace-addpanel-body"/>

                        <StackPanel Orientation="Horizontal"
                                    Spacing="10">
                            <DatePicker SelectedDate="{Binding ActiveUntilDate, Mode=TwoWay}" />
                            <TimePicker SelectedTime="{Binding ActiveUntilTime, Mode=TwoWay}" />
                        </StackPanel>
                    </StackPanel>

                    <!-- Restrictions -->
                    <StackPanel Classes="workspace-addpanel-body">
                        <TextBlock Text="Restrictions (optional)"
                                   Classes="workspace-addpanel-body"/>

                        <Expander Header="By day / month / monthday"
                                  IsExpanded="False">

                            <StackPanel Spacing="12" Margin="0,8,0,0">

                                <TextBlock Text="Weekdays (Mon–Sun)"
                                           Classes="workspace-addpanel-body"/>

                                <WrapPanel>
                                    <CheckBox Content="Mon" IsChecked="{Binding ByDayMon, Mode=TwoWay}" />
                                    <CheckBox Content="Tue" IsChecked="{Binding ByDayTue, Mode=TwoWay}" />
                                    <CheckBox Content="Wed" IsChecked="{Binding ByDayWed, Mode=TwoWay}" />
                                    <CheckBox Content="Thu" IsChecked="{Binding ByDayThu, Mode=TwoWay}" />
                                    <CheckBox Content="Fri" IsChecked="{Binding ByDayFri, Mode=TwoWay}" />
                                    <CheckBox Content="Sat" IsChecked="{Binding ByDaySat, Mode=TwoWay}" />
                                    <CheckBox Content="Sun" IsChecked="{Binding ByDaySun, Mode=TwoWay}" />
                                </WrapPanel>

                                <TextBlock Text="Months (Jan–Dec)"
                                           Classes="workspace-addpanel-body"/>

                                <WrapPanel>
                                    <CheckBox Content="Jan" IsChecked="{Binding ByMonthJan, Mode=TwoWay}" />
                                    <CheckBox Content="Feb" IsChecked="{Binding ByMonthFeb, Mode=TwoWay}" />
                                    <CheckBox Content="Mar" IsChecked="{Binding ByMonthMar, Mode=TwoWay}" />
                                    <CheckBox Content="Apr" IsChecked="{Binding ByMonthApr, Mode=TwoWay}" />
                                    <CheckBox Content="May" IsChecked="{Binding ByMonthMay, Mode=TwoWay}" />
                                    <CheckBox Content="Jun" IsChecked="{Binding ByMonthJun, Mode=TwoWay}" />
                                    <CheckBox Content="Jul" IsChecked="{Binding ByMonthJul, Mode=TwoWay}" />
                                    <CheckBox Content="Aug" IsChecked="{Binding ByMonthAug, Mode=TwoWay}" />
                                    <CheckBox Content="Sep" IsChecked="{Binding ByMonthSep, Mode=TwoWay}" />
                                    <CheckBox Content="Oct" IsChecked="{Binding ByMonthOct, Mode=TwoWay}" />
                                    <CheckBox Content="Nov" IsChecked="{Binding ByMonthNov, Mode=TwoWay}" />
                                    <CheckBox Content="Dec" IsChecked="{Binding ByMonthDec, Mode=TwoWay}" />
                                </WrapPanel>

                                <TextBlock Text="Monthdays (comma separated, e.g. 1,15,31)"
                                           Classes="workspace-addpanel-body"/>
                                <TextBox Classes="workspace-addpanel-body-text-oneliner"
                                         Watermark="1,15,31"
                                         Text="{Binding ByMonthDayCsv, Mode=TwoWay}" />
                            </StackPanel>
                        </Expander>
                    </StackPanel>

                    <!-- Action type -->
                    <StackPanel Classes="workspace-addpanel-body">
                        <TextBlock Text="Select action type"
                                   Classes="workspace-addpanel-body"/>

                        <ComboBox Classes="workspace-addpanel-body-selector"
                                  ItemsSource="{Binding ActionTypes}"
                                  SelectedValue="{Binding SelectedActionType}" />
                    </StackPanel>

                </StackPanel>
            </ScrollViewer>

            <Border Grid.Row="3"
                    Classes="panel-divider"/>

            <!-- Footer -->
            <Grid Grid.Row="4"
                  ColumnDefinitions="*,Auto"
                  VerticalAlignment="Center">

                <StackPanel Grid.Column="1"
                            Classes="confirm-cancel">
                    <Button Content="Cancel"
                            Classes="confirm-cancel-cancel"
                            Command="{Binding CloseAddPanelCommand}"/>
                    <Button Content="Create"
                            Classes="confirm-cancel-confirm"
                            Command="{Binding SubmitCreateScheduleCommand}"/>
                </StackPanel>

            </Grid>

        </Grid>
    </Border>
</UserControl>
