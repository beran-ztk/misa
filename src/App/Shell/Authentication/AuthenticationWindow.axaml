<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        x:Class="Misa.Ui.Avalonia.Shell.Authentication.AuthenticationWindow"
        xmlns:authentication="clr-namespace:Misa.Ui.Avalonia.Shell.Authentication"
        x:DataType="authentication:AuthenticationWindowViewModel"
        Width="900"
        Height="600"
        MinWidth="720"
        MinHeight="520"
        WindowStartupLocation="CenterScreen"
        CanResize="False">

    <Grid Background="{StaticResource BrushPrimaryBackgroundLighter}">

        <Border Background="{StaticResource BrushPrimaryBackgroundLight}"
                CornerRadius="10"
                Padding="30"
                Width="520"
                MaxWidth="640"
                HorizontalAlignment="Center"
                VerticalAlignment="Center">

            <StackPanel Spacing="14">

                <!-- Header -->
                <StackPanel Spacing="4">
                    <TextBlock Text="MISA"
                               FontSize="{StaticResource FontSizeLarge}"
                               Foreground="{StaticResource BrushTextFaded}"
                               Margin="0"/>

                    <TextBlock Text="{Binding SubtitleText}"
                               Margin="0"/>
                </StackPanel>

                <Border Height="1"
                        Background="{StaticResource BrushBorder}"
                        Opacity="0.35"/>

                <!-- Form -->
                <StackPanel Spacing="10">

                    <StackPanel Spacing="6">
                        <TextBlock Text="Username" Margin="0"/>
                        <TextBox Text="{Binding Username, Mode=TwoWay}"
                                 IsEnabled="{Binding IsNotBusy}"/>
                    </StackPanel>

                    <StackPanel Spacing="6">
                        <TextBlock Text="Password" Margin="0"/>
                        <TextBox Text="{Binding Password, Mode=TwoWay}"
                                 PasswordChar="•"
                                 IsEnabled="{Binding IsNotBusy}"/>
                    </StackPanel>

                    <StackPanel IsVisible="{Binding IsRegisterMode}"
                                Spacing="10">

                        <StackPanel Spacing="6">
                            <TextBlock Text="Confirm password" Margin="0"/>
                            <TextBox Text="{Binding ConfirmPassword, Mode=TwoWay}"
                                     PasswordChar="•"
                                     Watermark="Repeat password"
                                     IsEnabled="{Binding IsNotBusy}"/>
                        </StackPanel>

                        <StackPanel Spacing="6">
                            <TextBlock Text="Time zone" Margin="0"/>
                            <ComboBox ItemsSource="{Binding TimeZoneIds}"
                                      SelectedItem="{Binding SelectedTimeZoneId, Mode=TwoWay}"
                                      IsEnabled="{Binding IsNotBusy}"
                                      Height="38"
                                      HorizontalAlignment="Stretch"/>
                        </StackPanel>

                    </StackPanel>

                </StackPanel>

                <!-- Error banner -->
                <Border IsVisible="{Binding HasError}">
                    <TextBlock Text="{Binding ErrorMessage}"
                               Foreground="{StaticResource BrushError}"
                               TextWrapping="Wrap"/>
                </Border>

                <!-- Mode switch -->
                <StackPanel Spacing="6" HorizontalAlignment="Center">

                    <StackPanel Orientation="Horizontal"
                                Spacing="6"
                                HorizontalAlignment="Center"
                                IsVisible="{Binding IsLoginMode}">
                        <TextBlock Text="No account?"/>
                        <Button Content="Create one"
                                Command="{Binding SetRegisterModeCommand}"/>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal"
                                Spacing="6"
                                HorizontalAlignment="Center"
                                IsVisible="{Binding IsRegisterMode}">
                        <TextBlock Text="Already have an account?"/>
                        <Button Content="Sign in"
                                Command="{Binding SetLoginModeCommand}"/>
                    </StackPanel>

                </StackPanel>

                <!-- Actions -->
                <Grid ColumnDefinitions="Auto,*,Auto,Auto"
                      ColumnSpacing="10"
                      HorizontalAlignment="Stretch">

                    <Button Grid.Column="0"
                            Content="Bypass"
                            Command="{Binding BypassCommand}"
                            IsEnabled="{Binding IsNotBusy}"
                            Height="40"
                            VerticalContentAlignment="Center"
                            MinWidth="100"/>

                    <Border Grid.Column="1"/>

                    <Button Grid.Column="2"
                            Content="Close"
                            Command="{Binding CloseCommand}"
                            IsEnabled="{Binding IsNotBusy}"
                            Height="40"
                            VerticalContentAlignment="Center"
                            MinWidth="100"/>

                    <Button Grid.Column="3"
                            Content="{Binding PrimaryButtonText}"
                            Command="{Binding SubmitCommand}"
                            IsEnabled="{Binding CanSubmit}"
                            Height="40"
                            VerticalContentAlignment="Center"
                            MinWidth="100"/>
                </Grid>

            </StackPanel>
        </Border>
    </Grid>
</Window>
